#starting from the matrix containing the raw count data 
#using utilities "functions" within trinity to explore your data

1- perfom log2 and CPM transformation to obtain multi-pages results of mapped fragments and samples correlation 
providing a samples.txt file describing sample-replicate relationships 

module load R 
/apps/trinity/2.8.4/Analysis/DifferentialExpression/PtR --matrix RawCount.data --samples samples.txt --compare_replicates --CPM --log2 --min_rowSums 10

2-Obtain TMM normalised-FPKM matrix using edgeR 
library(edgeR)
rnaseqMatrix = read.table("RawCount.data", header=T, row.names=1, com='', check.names=F)
rnaseqMatrix = as.matrix(rnaseqMatrix)
rnaseqMatrix = round(rnaseqMatrix)
exp_study = DGEList(counts=rnaseqMatrix, group=factor(colnames(rnaseqMatrix)))
exp_study = calcNormFactors(exp_study) #the default method for computing scaling factors uses a trimmed mean of M-values (TMM) between each pair of samples. 
exp_study$samples$eff.lib.size = exp_study$samples$lib.size * exp_study$samples$norm.factors
logCPM <- cpm(exp_study, prior.count=2, log=TRUE)
FPKM <- logCPM(y) #where y is the gene length infor  
write.table(FPKM, file="FPKMCount.data", quote=F, sep="\t", row.names=F)

3- check your samples for outliers, compare replicates across all samples by generating a correlation matrix for all sample replicates using log2-FPKM (TMM normalised matrix)
module load R 
/apps/trinity/2.8.4/Analysis/DifferentialExpression/PtR --matrix FPKMCount.data --min_rowSums 10 -s samples.txt --sample_cor_matrix
#samples separated by tissues and T1 samples (control) clearly separted from post-maturation(T2-T4) samples 



